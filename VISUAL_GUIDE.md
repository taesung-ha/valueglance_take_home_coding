# 시각적 가이드 - 프로젝트 구조 이해하기

## 🎯 전체 구조 한눈에 보기

```
┌─────────────────────────────────────────────────────────┐
│                    브라우저 (Browser)                    │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│                   index.html                             │
│  ┌──────────────────────────────────────────────────┐   │
│  │  <div id="root"></div>  ← React가 여기에 그림    │   │
│  └──────────────────────────────────────────────────┘   │
│  <script src="/src/main.tsx"></script>                   │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│                   src/main.tsx                           │
│  ┌──────────────────────────────────────────────────┐   │
│  │  ReactDOM.createRoot(...).render(<App />)         │   │
│  │  → App 컴포넌트를 root div에 그리기              │   │
│  └──────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│                   src/App.tsx                            │
│  ┌──────────────────────────────────────────────────┐   │
│  │  function App() {                                │   │
│  │    return (                                      │   │
│  │      <div>                                       │   │
│  │        <header>제목</header>                    │   │
│  │        <StockDashboard /> ← 여기!               │   │
│  │      </div>                                      │   │
│  │    )                                             │   │
│  │  }                                               │   │
│  └──────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│          src/components/StockDashboard.tsx                │
│  ┌──────────────────────────────────────────────────┐   │
│  │  [State 관리]                                    │   │
│  │  - stocks: 주식 데이터                          │   │
│  │  - loading: 로딩 상태                           │   │
│  │  - error: 에러 메시지                           │   │
│  │  - searchQuery: 검색어                          │   │
│  └──────────────────────────────────────────────────┘   │
│  ┌──────────────────────────────────────────────────┐   │
│  │  [API 호출]                                      │   │
│  │  loadStocks() → stockApi.ts → Finnhub API      │   │
│  └──────────────────────────────────────────────────┘   │
│  ┌──────────────────────────────────────────────────┐   │
│  │  [렌더링]                                        │   │
│  │  <SearchBar />                                   │   │
│  │  <StockTable stocks={stocks} />                  │   │
│  │  <LoadingSpinner />                              │   │
│  │  <ErrorMessage />                                │   │
│  └──────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────┘
```

---

## 🔄 컴포넌트 계층 구조

```
App (최상위)
│
├── Header (제목)
│
└── StockDashboard (메인 로직)
    │
    ├── SearchBar (검색 입력)
    │   └── props: value, onChange
    │
    ├── Button (새로고침)
    │
    ├── Button (자동새로고침 토글)
    │
    ├── ErrorMessage (에러 표시)
    │   └── props: message, onDismiss
    │
    └── StockTable (데이터 테이블)
        └── props: stocks, sortField, sortDirection, onSort
            │
            └── TableRow (각 주식 행)
                ├── Symbol
                ├── Price
                └── % Change
```

---

## 📊 데이터 흐름도

```
┌──────────────┐
│   사용자     │
│  (브라우저)  │
└──────┬───────┘
       │
       │ 1. 웹사이트 접속
       ↓
┌─────────────────────┐
│    index.html       │
│  <div id="root">    │
└──────┬──────────────┘
       │
       │ 2. main.tsx 실행
       ↓
┌─────────────────────┐
│    main.tsx         │
│  ReactDOM.render()  │
└──────┬──────────────┘
       │
       │ 3. App 컴포넌트 렌더링
       ↓
┌─────────────────────┐
│    App.tsx          │
│  <StockDashboard /> │
└──────┬──────────────┘
       │
       │ 4. StockDashboard 렌더링
       ↓
┌─────────────────────────────────┐
│    StockDashboard.tsx           │
│                                 │
│  useEffect(() => {              │
│    loadStocks()  ←──────────┐   │
│  }, [])                      │   │
│                              │   │
│  const loadStocks = () => {  │   │
│    fetchMultipleStocks()     │   │
│  }                           │   │
└──────┬────────────────────────┘   │
       │                            │
       │ 5. API 함수 호출           │
       ↓                            │
┌─────────────────────┐            │
│   stockApi.ts       │            │
│                     │            │
│  fetchMultipleStocks│            │
│    ↓                │            │
│  fetch() → API      │            │
│    ↓                │            │
│  JSON 응답          │            │
│    ↓                │            │
│  StockData 변환     │            │
└──────┬──────────────┘            │
       │                           │
       │ 6. 데이터 반환             │
       └───────────────────────────┘
       │
       │ 7. setStocks(data)
       ↓
┌─────────────────────────────────┐
│    StockDashboard.tsx            │
│                                 │
│  stocks 상태 업데이트            │
│    ↓                            │
│  React가 자동으로               │
│  화면 다시 그리기                │
│    ↓                            │
│  <StockTable stocks={stocks} /> │
└──────┬──────────────────────────┘
       │
       │ 8. props로 데이터 전달
       ↓
┌─────────────────────┐
│   StockTable.tsx    │
│                     │
│  stocks.map()       │
│    ↓                │
│  각 행 렌더링       │
└──────┬──────────────┘
       │
       │ 9. 화면에 표시
       ↓
┌─────────────────────┐
│   사용자 화면       │
│  [테이블 표시됨]    │
└─────────────────────┘
```

---

## 🎨 State (상태) 관리 흐름

```
StockDashboard 컴포넌트 내부

┌─────────────────────────────────────────┐
│  초기 상태                              │
│  ┌───────────────────────────────────┐  │
│  │ stocks: []                        │  │
│  │ loading: true                     │  │
│  │ error: null                       │  │
│  │ searchQuery: ''                   │  │
│  └───────────────────────────────────┘  │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│  useEffect 실행 → loadStocks() 호출      │
│  ┌───────────────────────────────────┐  │
│  │ setLoading(true)                  │  │
│  │ → loading: true                  │  │
│  └───────────────────────────────────┘  │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│  API 호출 중...                          │
│  ┌───────────────────────────────────┐  │
│  │ 화면: <LoadingSpinner />          │  │
│  └───────────────────────────────────┘  │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│  API 응답 받음                           │
│  ┌───────────────────────────────────┐  │
│  │ setStocks(data)                  │  │
│  │ → stocks: [                      │  │
│  │   {symbol: 'AAPL', price: 150},  │  │
│  │   {symbol: 'MSFT', price: 200}   │  │
│  │ ]                                │  │
│  │                                  │  │
│  │ setLoading(false)                │  │
│  │ → loading: false                 │  │
│  └───────────────────────────────────┘  │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│  상태 변경 감지 → 화면 자동 업데이트     │
│  ┌───────────────────────────────────┐  │
│  │ <StockTable stocks={stocks} />     │  │
│  │ → 테이블에 데이터 표시             │  │
│  └───────────────────────────────────┘  │
└─────────────────────────────────────────┘
```

---

## 🔍 사용자 인터랙션 흐름

### 시나리오 1: 검색하기

```
사용자: 검색창에 "AAPL" 입력
    ↓
SearchBar 컴포넌트
    ↓
onChange 이벤트 발생
    ↓
setSearchQuery("AAPL") 호출
    ↓
searchQuery 상태 변경: '' → 'AAPL'
    ↓
useEffect 감지 (의존성: searchQuery)
    ↓
필터링 로직 실행
    ↓
stocks.filter(stock => stock.symbol.includes('AAPL'))
    ↓
setFilteredStocks(filtered) 호출
    ↓
filteredStocks 상태 변경
    ↓
React가 화면 다시 그리기
    ↓
StockTable에 필터링된 데이터만 표시
```

### 시나리오 2: 정렬하기

```
사용자: "Price" 컬럼 헤더 클릭
    ↓
StockTable의 <th onClick={() => onSort('price')} />
    ↓
handleSort('price') 호출
    ↓
setSortField('price') 호출
    ↓
sortField 상태 변경: 'symbol' → 'price'
    ↓
정렬 로직 재실행 (sortedStocks 재계산)
    ↓
stocks.sort((a, b) => a.price - b.price)
    ↓
React가 화면 다시 그리기
    ↓
테이블이 가격 순으로 정렬되어 표시
```

### 시나리오 3: 새로고침하기

```
사용자: "Refresh" 버튼 클릭
    ↓
<button onClick={handleRefresh} />
    ↓
handleRefresh() 호출
    ↓
loadStocks() 호출
    ↓
setLoading(true) → 로딩 시작
    ↓
API 호출 (fetchMultipleStocks)
    ↓
새로운 데이터 받아옴
    ↓
setStocks(newData) → 데이터 업데이트
    ↓
setLoading(false) → 로딩 끝
    ↓
React가 화면 다시 그리기
    ↓
최신 데이터로 테이블 업데이트
```

---

## 📦 파일별 역할 요약표

| 파일 | 역할 | 주요 내용 |
|------|------|----------|
| `index.html` | 진입점 | React가 그려질 빈 HTML |
| `main.tsx` | React 시작 | App 컴포넌트를 root에 렌더링 |
| `App.tsx` | 레이아웃 | 전체 페이지 구조, 헤더 |
| `StockDashboard.tsx` | 메인 로직 | 상태 관리, API 호출, 검색/정렬 |
| `StockTable.tsx` | 데이터 표시 | 테이블 렌더링, 포맷팅 |
| `SearchBar.tsx` | 검색 입력 | 검색어 입력 필드 |
| `LoadingSpinner.tsx` | 로딩 표시 | 회전하는 스피너 |
| `ErrorMessage.tsx` | 에러 표시 | 에러 메시지 박스 |
| `stockApi.ts` | API 호출 | Finnhub API 통신 |
| `stock.ts` | 타입 정의 | TypeScript 타입 |

---

## 🎯 핵심 개념 시각화

### useState 동작 원리

```
┌─────────────────────────────────────┐
│  const [value, setValue] =         │
│    useState(초기값)                 │
└─────────────────────────────────────┘
              │
              ├─ value: 현재 값 (읽기 전용)
              │
              └─ setValue: 값을 변경하는 함수
                  │
                  │ setValue(새값) 호출 시
                  │
                  ↓
         ┌─────────────────┐
         │  value 업데이트   │
         └────────┬─────────┘
                  │
                  ↓
         ┌─────────────────┐
         │  React 감지      │
         └────────┬─────────┘
                  │
                  ↓
         ┌─────────────────┐
         │  화면 다시 그리기 │
         └─────────────────┘
```

### Props 전달 흐름

```
부모 컴포넌트 (StockDashboard)
┌─────────────────────────────────────┐
│  const stocks = [...]               │
│                                     │
│  <StockTable                        │
│    stocks={stocks}  ←─── props 전달 │
│    onSort={handleSort}              │
│  />                                 │
└─────────────────────────────────────┘
              │
              │ 데이터 전달
              ↓
자식 컴포넌트 (StockTable)
┌─────────────────────────────────────┐
│  const StockTable = ({ stocks,      │
│                        onSort }) => │
│  {                                  │
│    // stocks 사용 가능              │
│    // onSort 사용 가능              │
│  }                                  │
└─────────────────────────────────────┘
```

### useEffect 실행 타이밍

```
컴포넌트 생명주기

┌─────────────────┐
│ 컴포넌트 생성    │
└────────┬────────┘
         │
         ↓
┌─────────────────┐
│ useEffect 실행  │ ← 컴포넌트가 화면에 나타날 때
│ (의존성 체크)   │
└────────┬────────┘
         │
         ↓
┌─────────────────┐
│ 화면에 표시됨    │
└────────┬────────┘
         │
         │ (의존성 변경 시)
         ↓
┌─────────────────┐
│ useEffect 재실행 │ ← 의존성이 변경되면 다시 실행
└────────┬────────┘
         │
         ↓
┌─────────────────┐
│ 컴포넌트 제거    │
└────────┬────────┘
         │
         ↓
┌─────────────────┐
│ cleanup 실행    │ ← return () => {...} 부분
└─────────────────┘
```

---

이제 프로젝트 구조를 시각적으로 이해하셨을 겁니다! 🎉


